{% extends "base.html" %}

{% block title %}MAS Finance - AI 투자 대시보드{% endblock %}

{% block content %}
<div class="container-fluid px-3 py-3">

    <!-- ============================================ -->
    <!-- 검색창 -->
    <!-- ============================================ -->
    <div class="search-box mb-4">
        <form action="/search" method="GET" class="position-relative">
            <input type="text"
                   name="q"
                   class="form-control form-control-lg search-input"
                   placeholder="종목명 또는 심볼을 입력하세요">
            <button type="submit" class="btn search-btn">
                <i class="bi bi-search"></i>
            </button>
        </form>
    </div>

    <!-- ============================================ -->
    <!-- 프로모션 배너 카드 -->
    <!-- ============================================ -->
    <div class="card promo-card mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div>
                <h5 class="card-title mb-1">2026년 유망종목 TOP5</h5>
                <p class="card-subtitle text-muted mb-2">미래에셋 전략팀 추천</p>
                <a href="/earnings" class="btn btn-primary btn-sm">자세히보기</a>
            </div>
            <div class="promo-icon">
                <i class="bi bi-graph-up-arrow"></i>
            </div>
        </div>
        <button type="button" class="btn-close promo-close" aria-label="Close"></button>
    </div>

    <!-- ============================================ -->
    <!-- 뉴스 알림 -->
    <!-- ============================================ -->
    <div class="news-alert mb-4">
        <div class="d-flex align-items-start">
            <i class="bi bi-megaphone-fill text-primary me-2 mt-1"></i>
            <p class="mb-0 small">
                <strong>[실적발표]</strong> 마이크로소프트, 주당순이익 4.14 달러..예상치 3.93 달러 상회
            </p>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- 시장 지수 카드들 -->
    <!-- ============================================ -->
    <div class="market-indices mb-4">
        <div class="row g-2">
            <!-- 다우 선물 -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card {{ 'up' if market_data.dow_futures.up else 'down' }}">
                    <span class="index-name">다우 선물</span>
                    <span class="index-value">{{ market_data.dow_futures.value }}</span>
                    <span class="index-change">
                        {% if market_data.dow_futures.up %}▲{% else %}▼{% endif %}
                        {{ market_data.dow_futures.change }} ({{ market_data.dow_futures.percent }})
                    </span>
                </div>
            </div>

            <!-- 나스닥 선물 -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card {{ 'up' if market_data.nasdaq_futures.up else 'down' }}">
                    <span class="index-name">나스닥 선물</span>
                    <span class="index-value">{{ market_data.nasdaq_futures.value }}</span>
                    <span class="index-change">
                        {% if market_data.nasdaq_futures.up %}▲{% else %}▼{% endif %}
                        {{ market_data.nasdaq_futures.change }} ({{ market_data.nasdaq_futures.percent }})
                    </span>
                </div>
            </div>

            <!-- S&P500 선물 -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card {{ 'up' if market_data.sp500_futures.up else 'down' }}">
                    <span class="index-name">S&P500 선물</span>
                    <span class="index-value">{{ market_data.sp500_futures.value }}</span>
                    <span class="index-change">
                        {% if market_data.sp500_futures.up %}▲{% else %}▼{% endif %}
                        {{ market_data.sp500_futures.change }} ({{ market_data.sp500_futures.percent }})
                    </span>
                </div>
            </div>

            <!-- 다우 지수 -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card {{ 'up' if market_data.dow.up else 'down' }}">
                    <span class="index-name">다우 지수</span>
                    <span class="index-value">{{ market_data.dow.value }}</span>
                    <span class="index-change">
                        {% if market_data.dow.up %}▲{% else %}▼{% endif %}
                        {{ market_data.dow.change }} ({{ market_data.dow.percent }})
                    </span>
                </div>
            </div>

            <!-- 나스닥 지수 -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card {{ 'up' if market_data.nasdaq.up else 'down' }}">
                    <span class="index-name">나스닥 지수</span>
                    <span class="index-value">{{ market_data.nasdaq.value }}</span>
                    <span class="index-change">
                        {% if market_data.nasdaq.up %}▲{% else %}▼{% endif %}
                        {{ market_data.nasdaq.change }} ({{ market_data.nasdaq.percent }})
                    </span>
                </div>
            </div>

            <!-- KOSPI (추가) -->
            <div class="col-6 col-md-4 col-lg-2">
                <div class="index-card up">
                    <span class="index-name">KOSPI</span>
                    <span class="index-value">2,536.80</span>
                    <span class="index-change">▲ 15.30 (+0.61%)</span>
                </div>
            </div>
        </div>
        <div class="text-end mt-2">
            <small class="text-muted">*기준 {{ "now" | default("26.01.29") }}</small>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- 마켓 스코어 카드 -->
    <!-- ============================================ -->
    <div class="card market-score-card mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div>
                <p class="mb-1">
                    <strong>마켓스코어 <span class="score-value">74점</span></strong>,
                    <span class="score-status warning">과욕</span> 단계입니다
                </p>
                <a href="/market" class="small text-primary">자세히 보기 <i class="bi bi-chevron-right"></i></a>
            </div>
            <div class="score-chart">
                <i class="bi bi-graph-up text-success fs-1"></i>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- 주요 기능 바로가기 (데스크톱) -->
    <!-- ============================================ -->
    <div class="d-none d-md-block">
        <h6 class="mb-3"><i class="bi bi-grid me-2"></i>주요 기능</h6>
        <div class="row g-3">
            <div class="col-md-4">
                <a href="/earnings" class="card feature-card h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-graph-up-arrow feature-icon text-primary"></i>
                        <h6 class="mt-2 mb-1">Earnings Trading</h6>
                        <small class="text-muted">Idio Score 기반 알파 발굴</small>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="/etf" class="card feature-card h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-pie-chart-fill feature-icon text-success"></i>
                        <h6 class="mt-2 mb-1">Active ETF</h6>
                        <small class="text-muted">TOP 1% 매니저 포트폴리오</small>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="/market" class="card feature-card h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-bar-chart-fill feature-icon text-info"></i>
                        <h6 class="mt-2 mb-1">MS Monitoring</h6>
                        <small class="text-muted">글로벌 시장 점유율 추적</small>
                    </div>
                </a>
            </div>
        </div>
    </div>

</div>
{% endblock %}
